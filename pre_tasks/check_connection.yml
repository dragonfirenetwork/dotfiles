---
# pre_tasks/check_connection.yml

- name: Check internet connection
  uri:
    url: "https://one.one.one.one"
    return_content: no
  register: internet_connection
  tags:
    - always

# If no internet connection
- name: Fail if no internet connection
  fail: msg="No internet connection, you must have an internet connection to run this playbook."
  when: internet_connection.status != 200